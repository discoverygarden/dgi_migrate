---
id: dgis_nodes
label: Create nodes from each FOXML File entity
migration_group: foxml_to_dgis
source:
  plugin: dgi_migrate.source.migration
  track_changes: true
  migration: dgis_foxml_files
destination:
  plugin: entity:node
  default_bundle: islandora_object
  translations: true
  validate: true
process:
  _node_foxml_parsed:
    - plugin: dgi_migrate.load_entity
      source: fid
      entity_type: entity:file
    - plugin: dgi_migrate.method
      method: getFileUri
    - plugin: dgi_migrate.parse_foxml
  _models:
    - plugin: dgi_migrate.method
      source: '@_node_foxml_parsed'
      method: models
    - plugin: skip_on_empty
      method: row
  title:
    - plugin: dgi_migrate.subproperty
      source: '@_node_foxml_parsed'
      property: label
    - plugin: default_value
      default_value: Untitled
  created:
    - plugin: dgi_migrate.subproperty
      source: '@_node_foxml_parsed'
      property: createdDate
    - plugin: callback
      callable: strtotime
  status:
    - plugin: dgi_migrate.subproperty
      source: '@_node_foxml_parsed'
      property: state
    - plugin: static_map
      map:
        'Active': 1
        'Inactive': 0
        'Deleted': 0
  uid:
    - plugin: default_value
      source: shared/default_uid
      default_value: 0
  field_pid:
    - plugin: dgi_migrate.subproperty
      source: '@_node_foxml_parsed'
      property: PID
  nid:
    - plugin: entity_lookup
      entity_type: node
      bundle_key: type
      bundle: islandora_object
      value_key: field_pid
      source: '@field_pid'
  _i8_model_uri:
    - plugin: static_map
      source: '@_models'
      bypass: false
      map:
        'info:fedora/islandora:sp_basic_image': 'http://purl.org/coar/resource_type/c_c513'
        'info:fedora/islandora:sp_large_image_cmodel': 'http://purl.org/coar/resource_type/c_c513'
        'info:fedora/ir:citationCModel': 'https://schema.org/DigitalDocument'
        'info:fedora/islandora:sp_pdf': 'https://schema.org/DigitalDocument'
        'info:fedora/islandora:sp_videoCModel': 'http://purl.org/coar/resource_type/c_12ce'
        'info:fedora/islandora:collectionCModel': 'http://purl.org/dc/dcmitype/Collection'
        'info:fedora/islandora:sp-audioCModel': 'http://purl.org/coar/resource_type/c_18cc'
        'info:fedora/islandora:binaryObjectCModel': 'http://purl.org/coar/resource_type/c_1843'
        'info:fedora/islandora:bookCModel': 'https://schema.org/Book'
        'info:fedora/islandora:pageCModel': 'http://id.loc.gov/ontologies/bibframe/part'
  field_model:
    - plugin: entity_lookup
      source: '@_i8_model_uri'
      bundle_key: vid
      bundle: islandora_models
      value_key: field_external_uri
      entity_type: taxonomy_term
      # XXX: migrate_plus's case comparison makes assumptions about the entity's
      # "main" property... we want "uri", but it assumes "value".
      ignore_case: true
    - plugin: skip_on_empty
      method: row
  field_display_hints:
    - plugin: dgi_migrate.process.static_map
      source: '@_i8_model_uri'
      bypass: true
      map:
        - ['https://schema.org/DigitalDocument', ['http://mozilla.github.io/pdf.js']]
        - ['http://purl.org/coar/resource_type/c_c513', ['http://openseadragon.github.io']]
    - plugin: flatten
    - plugin: skip_on_empty
      method: process
    - plugin: entity_lookup
      bundle_key: vid
      bundle: islandora_display
      value_key: field_external_uri
      entity_type: taxonomy_term
      # XXX: migrate_plus's case comparison makes assumptions about the entity's
      # "main" property... we want "uri", but it assumes "value".
      ignore_case: true
  field_weight:
    - plugin: dgi_migrate.method
      source: '@_node_foxml_parsed'
      method: sequenceNumber
  _mods_xpath:
    - plugin: dgi_migrate.subindex
      index: 'MODS'
      source: '@_node_foxml_parsed'
    - plugin: dgi_migrate.method
      method: getUri
    - plugin: dgi_migrate.process.xml.domfile
    - plugin: dgi_migrate.process.xml.xpath
      namespaces:
        mods: 'http://www.loc.gov/mods/v3'
        xsi: 'http://www.w3.org/2001/XMLSchema-instance'
        xlink: 'http://www.w3.org/1999/xlink'
  _mods_node:
    - plugin: dgi_migrate.method
      source: '@_mods_xpath'
      method: query
      args:
        - '//mods:mods[1]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: array_shift
  field_ark:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:identifier[@type="ark"]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: single_value
    - plugin: null_coalesce
  field_member_of:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:relatedItem[@type="host"]/mods:titleInfo/mods:title'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: entity_generate
      bundle_key: nid
      bundle: islandora_object
      value_key: label
      entity_type: node
  _coordinates:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:subject/mods:cartographic/mods:coordinates'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: str_replace
      search: ' '
      replace: ''
    - plugin: explode
      delimiter: ','
  'field_coordinates/lat': '@_coordinates/0'
  'field_coordinates/lng': '@_coordinates/1'
  field_coordinates_text:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:subject/mods:cartographic/mods:coordinates'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_edtf_date_created:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:originInfo/mods:dateCreated[@keydate="yes"]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_edtf_date_issued:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:originInfo/mods:dateIssued[@keydate="yes"]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_description:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:abstract'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: single_value
    - plugin: null_coalesce
  field_digital_origin:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:physicalDescription/mods:digitalOrigin'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_doi:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:identifier[@type="doi"]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: single_value
    - plugin: null_coalesce
  field_electronic_locator:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:location/mods:holdingSimple/mods:copyInformation/mods:electronicLocator'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: single_value
    - plugin: null_coalesce
  field_enumeration_and_chronology:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:location/mods:holdingSimple/mods:copyInformation/mods:enumerationAndChronology'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: single_value
    - plugin: null_coalesce
  field_extent:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:physicalDescription/mods:extent'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_faceted_subject:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:subject'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_paragraph_generate
      type: faceted_subject
      process_values: true
      values:
        field_authority_sources:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: '@authority'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_genre_form_subdivision_:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:genre'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
          - plugin: entity_generate
            bundle: genre
            bundle_key: vid
            entity_type: taxonomy_term
            value_key: name
        field_geographic_geographic_subd:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:geographic'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
          - plugin: entity_generate
            bundle: genre
            bundle_key: vid
            entity_type: taxonomy_term
            value_key: name
        field_temporal_chronological_sub:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:temporal'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
          - plugin: entity_generate
            bundle: temporal
            bundle_key: vid
            entity_type: taxonomy_term
            value_key: name
        field_topic_general_subdivision:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:topic'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
          - plugin: entity_generate
            bundle: subject
            bundle_key: vid
            entity_type: taxonomy_term
            value_key: name
  field_form:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:location/mods:holdingSimple/mods:copyInformation/mods:form'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_genre:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:genre'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: entity_generate
      bundle: genre
      bundle_key: vid
      entity_type: taxonomy_term
      value_key: name
  field_geographic_subject:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:subject/mods:geographic'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: entity_generate
      bundle: geo_location
      bundle_key: vid
      entity_type: taxonomy_term
      value_key: name
  field_handle:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:identifier[@type="hdl"]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: single_value
    - plugin: null_coalesce
  field_hierarchical_geographic_su:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:subject/mods:hierarchicalGeographic'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_paragraph_generate
      type: hierarchical_geographic_subject
      process_values: true
      values:
        field_area:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:area'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_city:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:city'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_city_section:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:citySection'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_continent:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:continent'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_country:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:country'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_county:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:county'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_extraterrestrial_area:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:extraterrestrialArea'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_island:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:island'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_region:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:region'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_state:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:state'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_territory:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:territory'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
  field_isbn:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:identifier[@type="isbn"]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: single_value
    - plugin: null_coalesce
  field_item_identifier:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:location/mods:holdingSimple/mods:copyInformation/mods:itemIdentifier'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: single_value
    - plugin: null_coalesce
  field_lcc_classification:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:classification[@authority="lcc"]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: single_value
    - plugin: null_coalesce
  field_local_identifier:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:identifier[@type="local"]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: single_value
    - plugin: null_coalesce
  field_note_location:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:location/mods:holdingSimple/mods:copyInformation/mods:note'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: single_value
    - plugin: null_coalesce
  field_note_paragraph:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:note'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_paragraph_generate
      type: note
      process_values: true
      values:
        field_note_type:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: '@type'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
          - plugin: single_value
          - plugin: null_coalesce
        field_note:
          - plugin: dgi_migrate.subproperty
            source: 'parent_value'
            property: nodeValue
  field_note:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:physicalDescription/mods:note'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: single_value
    - plugin: null_coalesce
  field_oclc_number:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:identifier[@type="oclc"]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: single_value
    - plugin: null_coalesce
  field_origin_information:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:originInfo'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_paragraph_generate
      type: origin_information
      process_values: true
      values:
        field_copyright_date:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:copyrightDate'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_date_captured:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:dateCaptured'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_date_created:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:dateCreated[@keydate="yes"]'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_date_issued:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:dateIssued[@keydate="yes"]'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_date_modified:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:dateModified'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_date_valid:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:dateValid'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_edition:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:edition'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_event_type:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: '@eventType'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_frequency:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:frequency'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_issuance:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:issuance'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_other_date:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:dateOther'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_place:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:place/mods:placeTerm'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_publisher:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:publisher'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
  field_part:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:part'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_paragraph_generate
      type: part
      process_values: true
      values:
        field_additional_information:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:text'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_caption:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:detail/mods:caption'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_date:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:date'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_end:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:extent/mods:end'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_extent:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:extent'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_extent_units:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:extent/@unit'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_list:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:extent/mods:list'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_number:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:detail/mods:number'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_part_order:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: '@order'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_part_type:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: '@type'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_start:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:extent/mods:start'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_title:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:detail/mods:title'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_total:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:extent/mods:total'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
  field_physical_form:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:physicalDescription/mods:form'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: entity_generate
      bundle: physical_form
      bundle_key: vid
      entity_type: taxonomy_term
      value_key: name
  field_physical_location:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:location/mods:physicalLocation'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_purl:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:identifier[@type="purl"]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_record_information:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:recordInfo'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_paragraph_generate
      type: record_information
      process_values: true
      values:
        field_description_standard:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:descriptionStandard'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_recording_catalog_language:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:languageOfCataloging'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_record_change_date:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:recordChangeDate'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_record_content_source:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: '.'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_record_creation_date:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:recordCreationDate'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_record_identifier:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:recordIdentifier'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_record_information_note:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:recordInfoNote'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_record_origin:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:recordOrigin'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
  field_reformatting_quality:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:physicalDescription/mods:reformattingQuality'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_related_item:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:relatedItem'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_paragraph_generate
      type: related_item
      process_values: true
      values:
        field_relationship_type:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: '@type'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_title_plain:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:titleInfo/mods:title'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
        field_url:
          - plugin: dgi_migrate.process.xml.context_query
            source: 'parent_value'
            xpath: 'parent_row/dest/_mods_xpath'
            query: 'mods:location/mods:url'
          - plugin: callback
            callable: iterator_to_array
          - plugin: multiple_values
          - plugin: dgi_migrate.subproperty
            property: nodeValue
  field_resource_type:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:typeOfResource'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: entity_generate
      bundle: resource_types
      bundle_key: vid
      entity_type: taxonomy_term
      value_key: name
  field_restriction_on_access:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:accessCondition[@type="restriction on access"]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_rights_statement:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:accessCondition[@type="use and reproduction"]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: entity_generate
      bundle: rights_statements
      bundle_key: vid
      entity_type: taxonomy_term
      value_key: name
  field_shelf_locator:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:location/mods:holdingSimple/mods:copyInformation/mods:shelfLocator'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_subject:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:subject/mods:topic'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: entity_generate
      bundle: subject
      bundle_key: vid
      entity_type: taxonomy_term
      value_key: name
  field_sub_location:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:location/mods:holdingSimple/mods:copyInformation/mods:subLocation'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_table_of_contents:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:tableOfContents'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_target_audience:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:targetAudience'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
  field_temporal_subject:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:tableOfContents'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property: nodeValue
    - plugin: entity_generate
      bundle: temporal
      bundle_key: vid
      entity_type: taxonomy_term
      value_key: name
  field_title:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:titleInfo'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_standard_title_paragraph
      xpath: '@_mods_xpath'
  field_use_and_reproduction:
    - plugin: dgi_migrate.process.xml.context_query
      source: '@_mods_node'
      xpath: '@_mods_xpath'
      query: 'mods:accessCondition[@type="use and reproduction"]'
    - plugin: callback
      callable: iterator_to_array
    - plugin: multiple_values
    - plugin: dgi_migrate.subproperty
      property:
migration_dependencies:
  required:
    - dgis_foxml_files
dependencies:
  enforced:
    module:
      - dgi_migrate
      - dgi_migrate_foxml_standard_mods
